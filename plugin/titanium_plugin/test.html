<html>
	<head>
		<script src="gears_init.js"/>
		<script src="titanium_styles.js"/>
		<script type="text/javascript">
			var desktop = google.gears.factory.create('beta.desktop');

			function $(id) { return document.getElementById(id); }
			function applyStyle (styleDef) {
				for (style in styleDef) {
					var props = styleDef[style];
					var styleNumber = 0;
					if (style == "_default") { styleNumber = 32; }
					else if (style == "_lineNumber") { styleNumber = 33; }
					else { styleNumber = parseInt(style); }
				
					if ('foreground' in props) {
						editor.setStyleForeground(styleNumber, props.foreground);
					}
					if ('background' in props) {
						editor.setStyleBackground(styleNumber, props.background);
					}
					if ('bold' in props) {
						editor.setStyleBold(styleNumber, props.bold);
					}
					if ('italic' in props) {
						editor.setStyleItalic(styleNumber, props.italic);
					}
				}
				editor.redraw();
			}

			function browse () {
				desktop.openFiles(function (files) { 
					var editor = $('editor');
					var file = files[0];

					$('filename').value = file.fullPath;
					var extension = file.name.substr(file.name.lastIndexOf('.')+1);
					editor.openFile(file.fullPath);

					if (extension == "py") {
						editor.setLanguage("python");
					} else if (extension == "rb") {
						editor.setLanguage("ruby");
					} else if (extension == "html")  {
						editor.setLanguage("hypertext");
					} else if (extension == "xml") {
						editor.setLanguage("xml");
					} else if (extension == "pl") {
						editor.setLanguage("perl");
					} else if (extension == "js") {
						editor.setLanguage("javascript");
					}

					var style = styles[extension];
					if (style != null) applyStyle(style);
				}, {singleFile: true});
			}
		</script>	
	</head>
	<body>
		<input type="text" id="filename" size="50"/>
		<button onclick="browse();" style="clear: both;">Open File...</button><br/>
		<div style="width: 100px; height: 700px; float: left; clear: left;">
			This might be a toolbar of some kind
		</div>
		<object
			src="test.xml"
			type="application/x-scintilla"
			width="500"
			height="700"
			style="border: 1px solid black; float: right;"
			id="editor"
		>
		</object>	

		<script>
			$('editor').setLanguage("xml");
			applyStyle(styles["xml"]);
		</script>
	</body>
</html>
