<project default="default">
	<target name="default">
		<mkdir dir="classes"/>
		<antcall target="build-grammar">
			<param name="grammar-file" value="src/org/appcelerator/titanium/idlgen/idl.g"/>
		</antcall>
		<javac srcdir="src" destdir="classes">
			<include name="**/*"/>
			<classpath>
				<fileset file="antlr.jar"/>
				<fileset file="freemarker.jar"/>
			</classpath>
		</javac>
	</target>

	<target name="run" depends="default">
		<java classname="org.appcelerator.titanium.idlgen.IDLGen" dir="${basedir}" fork="true">
			<classpath>
				<fileset file="antlr.jar"/>
				<fileset file="freemarker.jar"/>
				<path path="classes"/>
			</classpath>
			<arg line="${lang} ${file}"/>
			<arg value="${outdir}"/>
		</java>
	</target>

	<target name="build-grammar" >
		<java classname="antlr.Tool" fork="true" dir="${basedir}">
			<classpath>
				<fileset file="antlr.jar"/>
			</classpath>
			<jvmarg line="-Xmx512m -XX:MaxPermSize=128m"/>
			<arg line="-o src/org/appcelerator/titanium/idlgen/gen"/>
			<arg value="${grammar-file}"/>
		</java>
	</target>
</project>
